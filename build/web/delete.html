
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Registry Entry</title>
<script type="text/javascript" src="js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/registry.js"></script>
<!--  --link href="css/registry.css" rel="stylesheet"--!>
<!-- Bootstrap -->
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="css/bootstrap-theme.css" rel="stylesheet" media="screen">
<link href="css/bootstrap-theme.min.css" rel="stylesheet" media="screen">
        <!-- BOOTSTRAP STYLES-->
        <link href="css/bootstrap.css" rel="stylesheet" />
        <link href="css/toastr.min.css" rel="stylesheet" />
        <!-- FONTAWESOME STYLES-->
        <link href="css/font-awesome.css" rel="stylesheet" />
        <!-- CUSTOM STYLES-->
        <link href="css/custom.css" rel="stylesheet" />
        <!-- GOOGLE FONTS-->
        <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    </head>
    <body>
        <div id="wrapper">
            <nav class="navbar navbar-default navbar-cls-top " role="navigation" style="margin-bottom: 0">
                <div>
                <a><img src="img/esi_logo_white.png" style="align: center"></a> 
                <a> <font size="6" style="color: white"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        &nbsp;&nbsp;&nbsp;&nbsp;  Registry Management Service</font></a>
                </div>
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                </div>
                <div style="color: white;
                     padding: 15px 50px 5px 50px;
                     float: right;
                     font-size: 16px;"> </div>
            </nav>   
            <!-- /. NAV TOP  -->
            <nav class="navbar-default navbar-side" role="navigation">
                <div class="sidebar-collapse">
                    <ul class="nav" id="main-menu">
                        <li class="text-center">
                            
                        </li>
                        
                        <li>
                            <a id="anchAddEntry"  href="index.html"  ><i class="fa fa-plus-square fa-3x"></i> Add Entry</a>
                        </li>

                        <li>
                            <a id="anchSearchEntry"  href="search.html"><i class="fa fa-search fa-3x"></i> Search Entry</a>
                        </li>
                        
                        <li>
                            <a id="anchUpdateEntry"  href="update.html"><i class="fa fa-pencil-square-o fa-3x"></i> Update Entry</a>
                        </li>
                        <li  >
                            <a id="anchDeleteEntry"  href="#"><i class="fa fa-trash-o fa-3x"></i> Delete Entry</a>
                        </li>	

                    </ul>

                </div>

            </nav>  
            <!-- /. NAV SIDE  -->
            <div id="page-wrapper" >
                <div id="page-inner">
                    <div class="row">

                    </div>

                    <hr />
                    <div class="row">
                        <div class="col-md-3"></div>
                        <div class="col-md-6">
                            <!-- Form Elements -->
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 id="htagAdd">Add Registry Entry </h3>
                                    <h3 id="htagSearch">Search Registry Entry </h3>
                                    <h3 id ="htagUpdate">Update Registry</h3>
                                    <h3 id ="htagDelete">Delete Registry</h3>
                                </div>
                                <div id="dvAdd"  class="panel-body">
                                    
                                    <form role="form">
                                        <div id="regentrymsg1"></div>
                                        <div class="form-group">
                                            <label>Scope</label>
                                            <input class="form-control" id="regentryscope" type="text" required />

                                        </div>
                                        <div class="form-group">
                                            <label>Name</label>
                                            <input class="form-control" id="regentryname" type="text" required />
                                        </div>
                                        <div class="form-group">
                                            <label>Value</label>
                                            <input class="form-control" id="regentryvalue" type="text" required />
                                        </div>

                                        <div class="form-group">
                                            <div class="checkbox">
                                                <label>
                                                    <input type="checkbox" value="" id="regentryconfid">Confidential
                                                </label>
                                            </div>
                                        </div>

                                        <br/>
                                       
                                            <div class="form-inline"><div class="form-group" >
                                            <span  id="regentryaddbtn" ></span>
                                        	<button type="reset" class="btn btn-default" value="clear">Cancel</button> 
                                        </div>
                                        </div>
                                        
                                        

                                    </form>                            
                                </div>
                                <div  id="dvSearch" class="panel-body">
                                    
                                    <form role="form" novalidate>
                                        <div id="regentrymsg2"></div>
                                        <div class="form-group">
                                            <label>ID</label>
                                            <input class="form-control" id="regentryid2"  />

                                        </div><center><h3>OR</h3></center> </br>
                                        <div class="form-group">
                                            <label>Scope</label>
                                            <input class="form-control" id="regentryscope2"  />

                                        </div>
                                        <center><h3>OR</h3></center> </br>
                                        <div class="form-group">
                                            <label>Name</label>
                                            <input class="form-control" id="regentryname2"  />

                                        </div>
                                        
                                        <div class="form-group" style="display: none;">
                                            <label>value</label>
                                            <input class="form-control" id="regentryvalue2"  />

                                        </div>
                                        
                                        <div class="form-group">
                                            <div class="checkbox" style="display: none;">
                                                <label>
                                                    <input type="checkbox" id="regentryconfid2" value="" />Confidential
                                                </label>
                                            </div>
                                            <div class="checkbox">
                                                <label>
                                                    <input type="checkbox" id="useinheritance" value=""/>Use Inheritance
                                                </label>
                                            </div>
                                            <div class="checkbox" style="display: none;">
                                                <label>
                                                    <input type="checkbox" id="casesensitive" value=""/>Case Sensitive
                                                </label>
                                            </div>
                                        </div>


                                        
                                        <div class="form-inline"><div class="form-group" >
                                            <span  id="regentrysearchbtn" ></span>
                                        	<button type="reset" class="btn btn-default" value="clear">Cancel</button> 
                                        </div>
                                        </div>
                                       
                                   
                                    </form>
                                    
                                    
                                </div>
                                
                                <div id="dispdiv" class="col-md-offset-1 col-md-10"></div>

                                
                                <div id="dvUpdate"  class="panel-body">

                     <form role="form">
                        <div id="regentrymsg3"></div>
                                        <div class="form-group">
                                            <label>ID</label>
                                            <input class="form-control" name="id" id="regentryidx" />
                                           
                                        </div>
                                        <div class="form-group">
                                            <label>Scope</label>
                                            <input class="form-control" name="scope" id="regentryscopex" />
                                           
                                        </div>
                                        <div class="form-group">
                                            <label>Name</label>
                                            <input class="form-control" name="name" id="regentrynamex" placeholder="Example:com.express_scripts.services"  />
                                        </div>
                                        <div class="form-group">
                                            <label>Value</label>
                                            <input class="form-control" name="value" id="regentryvaluex"placeholder="Example:ref_product_app_dev1" />
                                        </div>
        
                                        <div class="form-group">
                                                <div class="checkbox">
                                                <label>
                                                    <input type="checkbox" name="checkbox" id="regentryconfidx" value="" />Confidential
                                                </label>
                                            </div>
                                        </div>                                                               
                                        
                                        <div class="form-inline"><div class="form-group" >
                                            <span  id="regentryupdatebtn" ></span>
                                        	<button type="reset" class="btn btn-default" value="clear">Cancel</button> 
                                        </div>
                                        </div>
                                        

                                    </form>                         
                                </div>

                                <div id="dvDelete"  class="panel-body">
                                  
                                    <form role="form">
                                        <div id="regentrymsg4"></div>
                                        <div class="form-group" >
                                            <label>ID</label>
                                            <input  type="text" id="reid" name="id" class="form-control"  />

                                        </div>


                                        <br/>
                                        <!-- <button type="submit" id="regentrydelbtn1">Delete</button> -->
                                        <div class="form-inline"><div class="form-group" >
                                            <span  id="Regentrydelbtn1" ></span>
                                        	<button type="reset" class="btn btn-default" value="clear">Cancel</button> 
                                        </div>
                                        </div>
                                        
                                    </form>                            
                                </div>

                            </div>
                            <!-- End Form Elements -->
                        </div>
                        <div class="col-md-3"></div>
                    </div>
                    <!-- /. ROW  -->

                    <!-- /. ROW  -->
                </div>
                <!-- /. PAGE INNER  -->
            </div>
            <!-- /. PAGE WRAPPER  -->
        </div>
        <!-- /. WRAPPER  -->
        <!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
        <!-- JQUERY SCRIPTS -->
        <!-- script src="js/jquery-1.10.2.js"></script> -->
        <!-- BOOTSTRAP SCRIPTS -->
        <script src="js/bootstrap.min.js"></script>
        <script src="js/toastr.min.js"></script>
        <!-- METISMENU SCRIPTS -->
        <!-- <script src="js/jquery.metisMenu.js"></script> -->
        <!-- CUSTOM SCRIPTS -->
        <script src="js/custom.js"></script>
        <script type="text/javascript" src="js/registry.js"></script>
        
        
        
        <script>

            $("#dvSearch").hide();
            $("#htagSearch").hide();
            $("#dvAdd").hide();
            $("#htagAdd").hide();
            $("#htagUpdate").hide();
            $("#dvUpdate").hide();
            $("#htagDelete").show();
            $("#dvDelete").show();

            $("#anchAddEntry").click(function () {
                $("#dvAdd").show();
                $("#htagAdd").show();
                $("#dvSearch").hide();
                $("#htagSearch").hide();
                $("#htagUpdate").hide();
            	$("#dvUpdate").hide();
                $("#htagDelete").hide();
                $("#dvDelete").hide();
                $( "#tblSearchResults" ).remove();
            });

            $("#anchSearchEntry").click(function () {
                $("#dvAdd").hide();
                $("#htagAdd").hide();
                $("#dvSearch").show();
                $("#htagSearch").show();
                $("#htagUpdate").hide();
            	$("#dvUpdate").hide();
                $("#htagDelete").hide();
                $("#dvDelete").hide();
                $( "#tblSearchResults" ).remove();
            });
            
             $("#anchDeleteEntry").click(function () {
                $("#dvAdd").hide();
                $("#htagAdd").hide();
                $("#dvSearch").hide();
                $("#htagSearch").hide();
                $("#htagDelete").show();
                $("#dvDelete").show();
                $("#htagUpdate").hide();
            	$("#dvUpdate").hide();
            	  $( "#tblSearchResults" ).remove();
            });
                        $("#anchUpdateEntry").click(function () {
                            $("#dvAdd").hide();
                            $("#htagAdd").hide();
                            $("#dvSearch").hide();
                            $("#htagSearch").hide();
                            $("#htagUpdate").show();
                        	$("#dvUpdate").show();
                            $("#htagDelete").hide();
                            $("#dvDelete").hide();
                            $( "#tblSearchResults" ).remove();
                        });
                        

        </script>
        
        <script src="https://fb.me/react-15.0.1.js"></script>
	<script src="https://fb.me/react-dom-15.0.1.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>

	<script type="text/babel">


        var EntryDelBtnByID = React.createClass({
	     delRegistryEntryByID : function(){
      	 var dentry = { "reid": String(this.props.id)};
         $.get("delRegistryEntry",
                {
                    dentry:JSON.stringify(dentry)
                },
                function (data, status) {
                    var resp = JSON.parse(data);

                    if (resp.regentid > 0)
						{
                         toastr.success("The record with id " + resp.regentid + " has been deleted successfuly");
						 $("#rw" + resp.regentid).remove();
						}
                     else 
                       toastr.error("There was an issue with deleting your record");

                });
           },
       	render() {
    			return <button type="button" className="btn btn-error" onClick= {this.delRegistryEntryByID}>
                          <span className="glyphicon glyphicon-trash" aria-label="Delete"></span>
                       </button>
  			}
		});


		class EntryDisplayRow extends React.Component {
  			render() {
    			return <tr id={"rw"+ this.props.id}>
						  <td className="ht3">{this.props.id}</td>
						  <td>{this.props.scope}</td>
						  <td>{this.props.name}</td>
						  <td>{this.props.value}</td>
						  <td>{this.props.confidential}</td>
						  <td><EntryEditBtn id={this.props.id} scope={this.props.scope} name={this.props.name} value={this.props.value} confidential={this.props.confidential}  /></td>
						  <td><EntryDelBtnByID id={this.props.id} /></td>
					   </tr>
  			}
		}


 

		class EntryTableHead extends React.Component {
  			render() {
    			return <tr>
						  <th width="6%" className="left ht3 back1">Id</th>
						  <th width="20%" className="left back1">Scope</th>
						  <th width="30%" className="left back1">Name</th>
						  <th width="10%" className="left back1">Value</th>
						  <th width="14%" className="left back1">Confidential</th>
						  <th width="10%" className="left back1">Edit</th>
						  <th width="10%" className="left back1">Delete</th>
					   </tr>
  			}
		}

		class EntryDisplayTable extends React.Component {
			render() {
				return <table id="tblSearchResults" width="100%" className="table table-striped">
                          <EntryTableHead />
						  {this.props.tbdata.map(function(tbcell){
						      var confd = "false";

							  if (tbcell.confidential === 1) {
								 confd = "true";
							  }

							  return <EntryDisplayRow id={tbcell.id} scope={tbcell.scope} name={tbcell.name} value={tbcell.value} confidential={confd} />
						  })}
					   </table>
			}
		}
                
                         
		var EntrySearchBtn = React.createClass({
            findRegistryEntry: function(){
			   var chkval1 = "false";

    		   if ($("#regentryconfid2").is(':checked')) {
        		  chkval1 = "true";
    		   }

    		   var chkval2 = "false";

    		   if ($("#useinheritance").is(':checked')) {
        		  chkval2 = "true";
    		   }

    		   var chkval3 = "false";

    		   if ($("#casesensitive").is(':checked')) {
        		  chkval3 = "true";
    		   }

			   var myentry = {
        		  "id":$("#regentryid2").val(),
                  "scope": $("#regentryscope2").val(),
                  "name": $("#regentryname2").val(),
        		  "value": $("#regentryvalue2").val(),
        		  "confidential": chkval1,
        		  "useInheritance": chkval2,
        		  "matchCase": chkval3
    		   };
                
   			   $("#regentryid2").val("");
    		   $("#regentryscope2").val("");
    		   $("#regentryname2").val("");
    		   $("#regentryvalue2").val("");

			   var tmpstr = JSON.stringify(myentry);

			   $("#dispdiv").html(tmpstr);

			   $.post("findRegistryEntry",
            	  {
                	myentry: tmpstr
            	  },

    			  function (data, status) {
        			var resp = JSON.parse(data);

        			var tblData = resp.results;
					console.log(resp.results);

        			if (resp.resultmsg.length == 0) {
            			ReactDOM.render(
  							<EntryDisplayTable tbdata={tblData} />,
  							document.getElementById('dispdiv')
						);
        			} else {
            			$("#regentrymsg2").show();

            			$("#regentrymsg2").html(resp.resultmsg);
						
        			}
    			  });
            },

            render: function(){
               return (
                  <button type="button" className = "btn btn-success" onClick={this.findRegistryEntry}>Search</button>
               );
            }
         });
       //  ReactDOM.render(<EntrySearchBtn />, document.getElementById('regentrysearchbtn'));

         var EntryEditBtn  = React.createClass({
    editEntry: function(event){
        		$("#dvAdd").hide();
                $("#htagAdd").hide();
                $("#dvSearch").hide();
                $("#htagSearch").hide();
                $("#htagDelete").hide();
                $("#dispdiv").hide();
                $("#dvDelete").hide();
                $("#htagUpdate").show();
            	$("#dvUpdate").show(); 
  				$("#regentryidx").val(this.props.id);
        		$("#regentryscopex").val(this.props.scope);
        		$("#regentrynamex").val(this.props.name);
        		$("#regentryvaluex").val(this.props.value); 
				$("#regentryconfidx").prop( "checked", this.props.confidential );
    },

    render() {
    			return <button type="button" onClick={this.editEntry} className="btn btn-default"  >
                          <span className="glyphicon glyphicon-edit" aria-label="Edit"></span>
                       </button>
  			}
	});
               
         
        var EntryAddBtn = React.createClass({
            addRegistryEntry: function(){
			   var chkval = "false";

        if ($("#regentryconfid").is(':checked')) {
            chkval = "true";
            console.log(chkval);
        }

        var crtentry = {
            "scope": $("#regentryscope").val(),
            "name": $("#regentryname").val(),
            "value": $("#regentryvalue").val(),
            "confidential": chkval
        };

        $("#regentryscope").val("");
        $("#regentryname").val("");
        $("#regentryvalue").val("");

        $.post("addRegistryEntry",
                {
                    crtentry: JSON.stringify(crtentry)
                },
                function (data, status) {
                    var resp = JSON.parse(data);
                 

                    if (resp.regentid > 0) {
                         toastr.success("The record has been added successfully");
                    } else {
                        
						toastr.error(resp.errormsg);
                    }
                });
            },

            render: function(){
               return (
                
				<button type="submit" className="btn btn-success" onClick={this.addRegistryEntry}>Add</button>
               );
            }
         });


         
        
    var EntryDeleteBtn = React.createClass({
            delRegistryEntry: function(){
			  
      var dentry = {
            "reid": $("#reid").val()
        };

        $("#reid").val("");
        
        
        $.get("delRegistryEntry",
                {
                    dentry:JSON.stringify(dentry)
                },
                function (data, status) {
                    var resp = JSON.parse(data);
                    console.log("delete");
                    $("#regentrymsg4").show();
                    console.log(resp.regentid);
                    if (resp.regentid > 0) {
                         toastr.success("The record with id " + resp.regentid + " has been deleted successfully");
						
                    } else {
						toastr.error(resp.errormsg);
                    }
                });
            },

            render: function(){
               return (
                  <button type="button" className="btn btn-success" onClick={this.delRegistryEntry}>Delete</button>
               );
            }
         });

         
        var EntryUpdateBtn = React.createClass({
            updateEntry: function(){
			   var chkvalupdate = "false";

        if ($("#regentryconfidx").is(':checked')) {
            chkvalupdate = "true";
        }

        var updatentry = {
            "id": $("#regentryidx").val(),
            "scope": $("#regentryscopex").val(),
            "name": $("#regentrynamex").val(),
            "value": $("#regentryvaluex").val(),
            "confidential": chkvalupdate
        };
        $("#regentryidx").val("");
        $("#regentryscopex").val("");
        $("#regentrynamex").val("");
        $("#regentryvaluex").val("");

        $.post("updateEntry",
                {
                    updatentry: JSON.stringify(updatentry)   
                },
                function (data, status) {
                    var resp = JSON.parse(data);
                   
                    $("#regentrymsg3").show();
                      if (resp.regentid > 0) {
                        toastr.success("The record with id " + resp.regentid + " has been updated successfully");
                    } else {
                        toastr.error(resp.errormsg);
                    }
                
                });
            },

            render: function(){
               return (
					<button type="submit" className="btn btn-success" onClick={this.updateEntry}>Update</button>
              
               );
            }
         });
        
       ReactDOM.render(<EntrySearchBtn />, document.getElementById('regentrysearchbtn'));
       ReactDOM.render(<EntryAddBtn />, document.getElementById('regentryaddbtn'));
       ReactDOM.render(<EntryDeleteBtn />, document.getElementById('Regentrydelbtn1'));
       ReactDOM.render(<EntryUpdateBtn />, document.getElementById('regentryupdatebtn'));
     
    </script>
    </body>
</html>
